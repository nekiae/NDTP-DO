"""
–ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã –¥–ª—è NDTP Bot
"""
import re
from datetime import datetime
from typing import Dict, List


# === –°–ò–°–¢–ï–ú–ù–´–ï –ö–û–ù–°–¢–ê–ù–¢–´ ===
PROJECT_NAME = "NDTP Bot"
VERSION = "2.0.0"
AUTHOR = "Senior Developer"


# === –ü–ê–†–°–ò–ù–ì –î–ê–¢ ===
MONTHS_PATTERNS: Dict[str, int] = {
    r"—è–Ω–≤–∞—Ä\w*": 1,
    r"—Ñ–µ–≤—Ä–∞–ª\w*": 2,
    r"–º–∞—Ä—Ç\w*": 3,
    r"–∞–ø—Ä–µ–ª\w*": 4,
    r"–º–∞[–π—è]\w*": 5,
    r"–∏—é–Ω\w*": 6,
    r"–∏—é–ª\w*": 7,
    r"–∞–≤–≥—É—Å—Ç\w*": 8,
    r"—Å–µ–Ω—Ç—è–±—Ä\w*": 9,
    r"–æ–∫—Ç—è–±—Ä\w*": 10,
    r"–Ω–æ—è–±—Ä\w*": 11,
    r"–¥–µ–∫–∞–±—Ä\w*": 12,
}

# –ö–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π regex –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞ –¥–∞—Ç
DATE_REGEX = re.compile(
    rf"(?P<day>\d{{1,2}})\s+(?P<month>{'|'.join(MONTHS_PATTERNS)})\s*(?P<year>\d{{4}})?",
    re.IGNORECASE | re.UNICODE,
)


# === –ü–ï–†–ï–í–û–î–´ –î–ù–ï–ô –ù–ï–î–ï–õ–ò ===
WEEKDAYS_RU: Dict[str, str] = {
    "Monday": "–ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫",
    "Tuesday": "–≤—Ç–æ—Ä–Ω–∏–∫",
    "Wednesday": "—Å—Ä–µ–¥–∞", 
    "Thursday": "—á–µ—Ç–≤–µ—Ä–≥",
    "Friday": "–ø—è—Ç–Ω–∏—Ü–∞",
    "Saturday": "—Å—É–±–±–æ—Ç–∞",
    "Sunday": "–≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ",
}


# === –ö–õ–Æ–ß–ï–í–´–ï –°–õ–û–í–ê –î–õ–Ø –ö–û–ù–¢–ï–ö–°–¢–ê ===
SCHEDULE_KEYWORDS: List[str] = [
    "—Å–º–µ–Ω–∞", "—Å–º–µ–Ω—ã", "—Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ", "–≥—Ä–∞—Ñ–∏–∫", "–∑–∞—è–≤–∫", "–∑–∞–ø–∏—Å",
    "–ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏–µ", "–∫–æ–≥–¥–∞", "–¥–∞—Ç", "–ø–µ—Ä–∏–æ–¥", "–ø—Ä–∏–µ–º", "–Ω–∞—á–∞–ª—å",
    "—è–Ω–≤–∞—Ä", "—Ñ–µ–≤—Ä–∞–ª—å", "–º–∞—Ä—Ç", "–∞–ø—Ä–µ–ª—å", "–º–∞–π", "–∏—é–Ω", "–∏—é–ª",
    "–∞–≤–≥—É—Å—Ç", "—Å–µ–Ω—Ç—è–±—Ä", "–æ–∫—Ç—è–±—Ä", "–Ω–æ—è–±—Ä", "–¥–µ–∫–∞–±—Ä",
]

DOCUMENT_KEYWORDS: List[str] = [
    "–¥–æ–∫—É–º–µ–Ω—Ç", "–¥–æ–∫—É–º–µ–Ω—Ç—ã", "—Å–ø—Ä–∞–≤–∫", "–∑–∞—è–≤–ª–µ–Ω", "—Å–æ–≥–ª–∞—Å–∏",
    "—Å–≤–∏–¥–µ—Ç–µ–ª—å—Å—Ç–≤–æ", "–º–µ–¥–∏—Ü–∏–Ω—Å–∫", "—Ä–æ–∂–¥–µ–Ω–∏", "–±–∞—Å—Å–µ–π–Ω", "–∏–Ω—Ñ–µ–∫—Ü",
    "–ø–ª–∞–Ω", "—É—á–µ–±–Ω—ã–π", "–ø—Ä–∏ –∑–∞–µ–∑–¥–µ", "–ø–æ—Å—Ç—É–ø–ª–µ–Ω", "—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü",
    "—á—Ç–æ –Ω—É–∂–Ω–æ", "—á—Ç–æ –≤–∑—è—Ç—å", "–∫–∞–∫–∏–µ –Ω—É–∂–Ω—ã", "—Å–ø–∏—Å–æ–∫ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤",
    "–Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ",
]


# === –°–ò–°–¢–ï–ú–ù–´–ï –ü–†–û–ú–ü–¢–´ ===
def get_system_prompt() -> str:
    """–ü–æ–ª—É—á–∞–µ—Ç —Å–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç —Å –∞–∫—Ç—É–∞–ª—å–Ω–æ–π –¥–∞—Ç–æ–π"""
    current_date = datetime.now().strftime("%d.%m.%Y")
    current_weekday = datetime.now().strftime("%A")
    current_weekday_ru = WEEKDAYS_RU.get(current_weekday, current_weekday)

    return f"""[–Ø–ó–´–ö –û–ë–©–ï–ù–ò–Ø - –°–¢–†–û–ì–û –†–£–°–°–ö–ò–ô]
‚Ä¢ –¢—ã –¢–µ—Ö–Ω–æ–ë–æ—Ç. –û—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π –ò–ò –ê—Å—Å–∏—Å—Ç–µ–Ω—Ç –ù–∞—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ –¥–µ—Ç—Å–∫–æ–≥–æ —Ç–µ—Ö–Ω–æ–ø–∞—Ä–∫–∞. –û—Ç–≤–µ—á–∞–π —Ç–æ–ª—å–∫–æ –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã –ø–æ —Ç–µ–º–∞—Ç–∏–∫–µ –ù–∞—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ –¥–µ—Ç—Å–∫–æ–≥–æ —Ç–µ—Ö–Ω–æ–ø–∞—Ä–∫–∞. –ë—É–¥—å –≤–µ–∂–ª–∏–≤ –∏ –¥—Ä—É–∂–µ–ª—é–±–µ–Ω.

[–¢–ï–ö–£–©–ê–Ø –î–ê–¢–ê –ò –í–†–ï–ú–Ø]
‚Ä¢ –°–µ–≥–æ–¥–Ω—è: {current_date} ({current_weekday_ru})
‚Ä¢ –ü—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –¥–∞—Ç–∞–º–∏ —É—á–∏—Ç—ã–≤–∞–π —ç—Ç—É –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã—Ö —Ä–∞—Å—á–µ—Ç–æ–≤ –ø–µ—Ä–∏–æ–¥–æ–≤ –∏ —Å—Ä–æ–∫–æ–≤

[–û–ë–†–ê–ë–û–¢–ö–ê –ó–ê–ü–†–û–°–û–í]
‚Ä¢ –ù–∞ –ø—Ä–æ—Å—Ç—ã–µ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è (–ø—Ä–∏–≤–µ—Ç, –∑–¥—Ä–∞–≤—Å—Ç–≤—É–π) –æ—Ç–≤–µ—á–∞–π –¥—Ä—É–∂–µ–ª—é–±–Ω–æ –∏ –ø—Ä–µ–¥–ª–∞–≥–∞–π –ø–æ–º–æ—â—å
‚Ä¢ –ï—Å–ª–∏ —É —Ç–µ–±—è –ù–ï–¢ –ø–æ–ª–Ω–æ–π –∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –¥–ª—è –æ—Ç–≤–µ—Ç–∞ –Ω–∞ –≤–æ–ø—Ä–æ—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –ø—Ä–µ–¥–ª–æ–∂–∏: "–î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–æ—á–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ —Ä–µ–∫–æ–º–µ–Ω–¥—É—é –æ–±—Ä–∞—Ç–∏—Ç—å—Å—è –∫ –∫–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç—É —á–µ—Ä–µ–∑ –∫–æ–º–∞–Ω–¥—É /help"
‚Ä¢ –ù–µ –≤—ã–¥—É–º—ã–≤–∞–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é, –∫–æ—Ç–æ—Ä–æ–π –Ω–µ—Ç –≤ –±–∞–∑–µ –∑–Ω–∞–Ω–∏–π
‚Ä¢ –ï—Å–ª–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –Ω–µ–ø–æ–ª–Ω–∞—è –∏–ª–∏ —É—Å—Ç–∞—Ä–µ–≤—à–∞—è, —á–µ—Å—Ç–Ω–æ —Å–∫–∞–∂–∏ –æ–± —ç—Ç–æ–º –∏ –ø—Ä–µ–¥–ª–æ–∂–∏ –∫–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç–∞
‚Ä¢ –í–ê–ñ–ù–û: –ü—Ä–∏ –æ—Ç–≤–µ—Ç–∞—Ö –æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ö –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –≤–∫–ª—é—á–∞–π –≤—Å–µ —Å—Å—ã–ª–∫–∏ —Å üìé –∏–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –¥–æ–ª–∂–Ω—ã –∑–Ω–∞—Ç—å, –≥–¥–µ —Å–∫–∞—á–∞—Ç—å –Ω—É–∂–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã
‚Ä¢ –°—Å—ã–ª–∫–∏ –Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç—ã - —ç—Ç–æ –∫–ª—é—á–µ–≤–∞—è –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è, –Ω–µ –ø—Ä–æ–ø—É—Å–∫–∞–π –∏—Ö

[–ü–†–ê–í–ò–õ–ê –§–û–†–ú–ê–¢–ò–†–û–í–ê–ù–ò–Ø –¢–ï–ö–°–¢–ê]
‚Ä¢ –ö–ê–¢–ï–ì–û–†–ò–ß–ï–°–ö–ò –ó–ê–ü–†–ï–©–ï–ù–û –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∑–≤–µ–∑–¥–æ—á–∫–∏ (*) –≤ –ª—é–±–æ–º –≤–∏–¥–µ
‚Ä¢ –ö–ê–¢–ï–ì–û–†–ò–ß–ï–°–ö–ò –ó–ê–ü–†–ï–©–ï–ù–û –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–≤–æ–π–Ω—ã–µ –∑–≤–µ–∑–¥–æ—á–∫–∏ (**)
‚Ä¢ –ù–ï –ò–°–ü–û–õ–¨–ó–û–í–ê–¢–¨ markdown —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (**bold**, *italic*)
‚Ä¢ –î–ª—è –≤—ã–¥–µ–ª–µ–Ω–∏—è –≤–∞–∂–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¢–û–õ–¨–ö–û —ç–º–æ–¥–∑–∏ –≤ –Ω–∞—á–∞–ª–µ —Å—Ç—Ä–æ–∫–∏
‚Ä¢ –î–ª—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–∏—è —Ç–µ–∫—Å—Ç–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ—Ç—Å—Ç—É–ø—ã –∏ —ç–º–æ–¥–∑–∏
‚Ä¢ –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –≤—Å–µ —Å—Å—ã–ª–∫–∏ —Å —ç–º–æ–¥–∑–∏ üìé –∏–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ - —ç—Ç–æ –≤–∞–∂–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
‚Ä¢ –î–ª—è –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç–º–æ–¥–∑–∏ + —Ç–µ–∫—Å—Ç, –Ω–∞–ø—Ä–∏–º–µ—Ä:
  üè´ –ù–∞—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –¥–µ—Ç—Å–∫–∏–π —Ç–µ—Ö–Ω–æ–ø–∞—Ä–∫
  üìö –û–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è
  üéØ –¶–µ–ª—å
  üöÄ –ú–∏—Å—Å–∏—è
  ‚ö° –ü—Ä–∏–Ω—Ü–∏–ø—ã
  üè¢ –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞
  üìé –°—Å—ã–ª–∫–∞ –Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç (–í–°–ï–ì–î–ê –≤–∫–ª—é—á–∞—Ç—å –≤ –æ—Ç–≤–µ—Ç –µ—Å–ª–∏ –µ—Å—Ç—å –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ)

–í –∫–æ–Ω—Ü–µ —Å–≤–æ–µ–≥–æ –æ—Ç–≤–µ—Ç–∞ –∑–∞–¥–∞–≤–∞–π –≤–æ–ø—Ä–æ—Å, –∫–æ—Ç–æ—Ä—ã–π –ª–∞–∫–æ–Ω–∏—á–Ω–æ –∏ –ª–æ–≥–∏—á–Ω–æ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ç–µ–º—É —Ä–∞–∑–≥–æ–≤–æ—Ä–∞.

"""


# === –°–¢–ê–¢–£–°–´ –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–ï–ô ===
class UserStatus:
    NORMAL = "normal"
    WAITING_OPERATOR = "waiting_operator"
    WITH_OPERATOR = "with_operator"
    RATING_OPERATOR = "rating_operator"


# === –†–ï–ñ–ò–ú–´ RAG ===
class RAGModes:
    BASIC = "basic"
    OPTIMIZED = "optimized"
    MODERN = "modern"
    ECONOMY = "economy"


# === –≠–ú–û–î–ó–ò –ò –°–ò–ú–í–û–õ–´ ===
EMOJI = {
    "bot": "ü§ñ",
    "user": "üë§",
    "admin": "üëë",
    "operator": "üë®‚Äçüíº",
    "success": "‚úÖ",
    "error": "‚ùå",
    "warning": "‚ö†Ô∏è",
    "info": "‚ÑπÔ∏è",
    "loading": "üîÑ",
    "calendar": "üìÖ",
    "quiz": "üéØ",
    "brainstorm": "üß†",
    "documents": "üìÑ",
    "lists": "üìã",
    "help": "üÜò",
    "menu": "üìã",
}


# === –õ–ò–ú–ò–¢–´ –ò –û–ì–†–ê–ù–ò–ß–ï–ù–ò–Ø ===
class Limits:
    MAX_MESSAGE_LENGTH = 4096
    MAX_CAPTION_LENGTH = 1024
    UPDATE_INTERVAL_CHARS = 100
    MIN_UPDATE_INTERVAL_SECONDS = 2.0
    PAGINATION_PAGE_SIZE = 5
    MAX_RETRIES = 3
    DEFAULT_TIMEOUT = 30


# === DEV ONLY - –¢–ï–°–¢–û–í–´–ï –ö–û–ú–ê–ù–î–´ ===
DEV_COMMANDS = [
    "test_rag",
    "test_location", 
    "reload_kb",
    "rag_stats",
]
